<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:CrowsNestMqtt.UI.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="600"
             x:Class="CrowsNestMqtt.UI.Views.MainView"
             x:DataType="vm:MainViewModel">

  <Design.DataContext>
    <!-- This DataContext is used only for design-time IntelliSense. -->
    <!-- It is overridden at runtime by the ViewModel assigned in code-behind -->
    <vm:MainViewModel />
  </Design.DataContext>

  <Grid RowDefinitions="Auto,*" ColumnDefinitions="Auto,*">

    <!-- Top Command/Search Bar -->
    <TextBox Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"
             Watermark="Enter command or search query..."
             Text="{Binding CommandText}"
             Margin="5"/>

    <!-- Left Panel: Topic List -->
    <Border Grid.Row="1" Grid.Column="0" BorderBrush="Gray" BorderThickness="0,0,1,0" MinWidth="150">
        <ListBox ItemsSource="{Binding Topics}" Margin="5">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding}" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Border>

    <!-- Right Panel: Split View for History and Details -->
    <SplitView Grid.Row="1" Grid.Column="1" PanePlacement="Right" DisplayMode="Inline" IsPaneOpen="True" OpenPaneLength="200">
        <SplitView.Pane>
            <!-- Bottom Pane: Message Details -->
            <Border BorderBrush="Gray" BorderThickness="0,1,0,0" Padding="5">
                <TextBlock Text="{Binding MessageDetails}" TextWrapping="Wrap"/>
            </Border>
        </SplitView.Pane>
        <SplitView.Content>
            <!-- Top Content: Message History -->
             <ListBox ItemsSource="{Binding MessageHistory}" Margin="5">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </SplitView.Content>
    </SplitView>

  </Grid>
</UserControl>